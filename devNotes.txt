TODO

   simple optimizations: don't use shared ptr

   throw bananas more intelligently
      only consider if the points are great

   add select!

   fix agent runaway
   heavier playthroughs (biases)

   make tourneys 50/50 p1/p2
   scrape match logs for stats

   2 weird cases:
      end of game showdown, i have more health - why not shoot him??
         cant see till the end of the game, points wise makes sense to rather dodge
      my (not last) worm about to die - why not evade?

   Need to avoid getting lost
      try using seed/jippo'd game state to reproduce this
      one solution - bias towards moving in a direction
      another solution - low confidence, go for heuristic 
         aim for big clump of dirt if health looking bad
         go for enemies if health looking good
         run away if at a points advantage

   Tuning
       make bot tunable via config file
       update tournament script
       upload after doing this if better

   add some carry-over state
      ISSUE: I NEED TO KEEP TRACK OF ENEMY BANANA BOMBS
         currently always assuming he has 3 - it's not in the state file
      consecutivedonothing count for opponent isnt in file!
      previousposition is wrong when loading file!

   run compare over LOTS of matches
   make monte carlo choose random if tie

   explicit exclude of potential game ending move
      explicit exclude of all chances for opponent to shoot?
         add unit tests for this
       
   upload bot!

   spreadsheet profile of opponents
      run grep on match logs
       scrape logs to find their output
   
sort out deployment---------------
        known issue: with cell.cpp (global method)
        known issue: with std::ceil line
           c++ std?
        known issue: incorrect case in header includes
        copy bot folder
        drag in gameengine and random lib
        remove bin/rounds
        make changes to makefile (folders)
        get rid of all cerr?
           use a log wrapper function that can be disabled
         make sure its not a debug build
         undefine EXCEPTION_ON_ERROR

MISC NOTES--------------------
to scan match logs for No Commands:

find . -wholename "*JP3/PlayerCommand*" -exec grep -A 1 "No Command" {} +
find . -wholename "*JP3/PlayerCommand*" -exec grep -A 1 "nothing" {} +

BRAINSTORMING---------------------------------------------------------------------------------------

    try
       playthroughs considering only nearby worms
        if theres a tie choose random
        monte carlo with evaluation
            bias moves in favour of continuing in the same direction
            getting invalid moves
            check which one is better, trim or no
            returns scores from playthroughs (not just +/-1)
            run sims on a per worm basis
            run matches with extended play time
                confirm that longer playtime makes smarter bot
                check if bot wins sooner with longer play time?
        minimax with evaluation
            plug in strategies for each player
            learn/estimate strategy while you play??
        "mixed" strategy?

        coward worms? make the enemy waste time

        if you don't use select early on you've wasted it
         check if im just using +-1 for playthroughs - should prob add bias there
         disregard moves that would result in instant loss...
         penalise playthroughs that result in loss heavily
         do the move-in-a-line bias for yourself and the other worms

         (the opponent worms, during the playthrough)
         Prune the search tree by recognising symmetries

insights from replays-----------------------------------------------------------------
        bots can get "lost" if they are in wide open spaces
            check confidence of next move, use heuristics if not sure?
            happened against nico beukes
        reference bot strategy is quite popular
        
to run bot on state file:--------------------------------------------
 - copy file to bin/rounds/roundnumber/state.json
 - cd into bin folder
 - run bot
 - input round number


bot description --------------------------------------------------------------------
jp2 - what i submitted for Early Bird.  basic monte carlo, buggy
jp3 - jp2 with various bug fixes
jp4 - jp3 with optimizations to GetRandomMoveForWorm and added multithreading.  Plies/s up from ~600k to 1.2M
jp5 - jp4 with simple bananas - consider chucking at any enemies in range
jp6 - added radius of worms to consider (but it doesn't help, so set infinite.)  Added weighted playthroughs
jp7 - optimised version of jp6

results analysis --------------------------------------------------------------------
increasing depth to 24 - no noticable improvement
   reducing to 15 - seems to actually be a bit worse
   reducing to 7 - noticably better than jp2, and does better against reference bot

using scorediff, and modifying c to 4, putting playthrough depth back to 24
   lost every game think i did it wrong....
   looking at UCT scores, looks like it converges too quickly, so try raising c to 8
   Need to get back to this after bug fixes

upped the time limit to 3s, improvement not great.  beats reference bot and 1s jp2 66% of the time
   (wins/draws/losses):     reference-bot            jp2                      jp3                      
   reference-bot:           0/0/0                    15/0/5                   5/0/15                   (20/0/20)
   jp2:                     5/0/15                   0/0/0                    6/0/14                   (11/0/29)
   jp3:                     15/0/5                   14/0/6                   0/0/0                    (29/0/11)

after fixing some edge case bugs in the engine and putting playthrough depth back to 24 (engine version 2019.2.1):
   (wins/draws/losses):     reference-bot            jp2                      jp3                      
   reference-bot:           0/0/0                    84/0/53                  70/0/67                  (154/0/120)
   jp2:                     53/0/84                  0/0/0                    17/0/120                 (70/0/204)
   jp3:                     67/0/70                  120/0/17                 0/0/0                    (187/0/87)

after optimising engine and adding multithreading (depth still 24) (engine version 2019.2.2)
(wins/draws/losses):     reference-bot            jp3                      jp2                      
reference-bot:           0/0/0                    10/0/23                  17/0/16                  (27/0/39)
jp3:                     23/0/10                  0/0/0                    19/0/14                  (42/0/24)
jp2:                     16/0/17                  14/0/19                  0/0/0                    (30/0/36)

some more of the same^ but redirecting std::err to /dev/null (suspect foul play by jp2)

(wins/draws/losses):     reference-bot            jp3                      jp2                      
reference-bot:           0/0/0                    16/0/16                  16/0/16                  (32/0/32)
jp3:                     16/0/16                  0/0/0                    20/0/12                  (36/0/28)
jp2:                     16/0/16                  12/0/20                  0/0/0                    (28/0/36)

bringing back the old one as jp3 and making current one jp4:

Engine version: 2019.2.2
(wins/draws/losses):     reference-bot            jp2                      jp3                      jp4                      
reference-bot:           0/0/0                    26/0/19                  21/0/24                  18/0/27                  (65/0/70)
jp2:                     19/0/26                  0/0/0                    4/2/39                   6/2/37                   (29/4/102)
jp3:                     24/0/21                  39/2/4                   0/0/0                    9/0/36                   (72/2/61)
jp4:                     27/0/18                  37/2/6                   36/0/9                   0/0/0                    (100/2/33)

Added banana bombs! still has bugs tho
Engine version: 2019.2.2
(wins/draws/losses):     jp5                      jp4                      
jp5:                     0/0/0                    29/0/12                  (29/0/12)
jp4:                     12/0/29                  0/0/0                    (12/0/29)

Engine version: 2019.2.2
(wins/draws/losses):     jp5                      jp3                      jp2                      reference-bot            
jp5:                     0/0/0                    12/0/6                   18/0/0                   18/0/0                   (48/0/6)
jp3:                     6/0/12                   0/0/0                    11/0/7                   13/0/5                   (30/0/24)
jp2:                     0/0/18                   7/0/11                   0/0/0                    8/0/10                   (15/0/39)
reference-bot:           0/0/18                   5/0/13                   10/0/8                   0/0/0                    (15/0/39)

added radius, seems to make things worse :/ same code with infinite radius:------------------------------------------------------------------------
Engine version: 2019.2.2
(wins/draws/losses):     jp6                      jp5                      reference-bot            
jp6:                     0/0/0                    19/0/12                  27/0/4                   (46/0/16)

made radius (distance to nearest enemy)*2---------------------------------------------------------------------------------------------
Engine version: 2019.2.2
(wins/draws/losses):     jp6                      jp5                      jp4                      reference-bot            
jp6:                     0/0/0                    0/0/32                   16/0/16                  26/0/6                   (42/0/54)

infinite radius - seems to be no different to jp5 :/ -------------------------------------------------------------------------------------
Engine version: 2019.2.2
(wins/draws/losses):     jp6                      jp5                      jp4                      reference-bot            
jp6:                     0/0/0                    21/0/24                  42/0/3                   43/0/2                   (106/0/29)

add weighted playthroughs... (combined more than 1 run's results here)----------------------------------------------------------------------------------
Engine version: 2019.2.2
(wins/draws/losses):     jp6                      jp5                      reference-bot            
jp6:                     0/0/0                    48/0/24                  31/0/0           

OPTIMISE (supersnob)-(1.5M plies/s)---------------------------------------------------------------------------------------------------------------------
Engine version: 2019.2.2
(wins/draws/losses):     jp7                      jp6                      
jp7:                     0/0/0                    46/0/20                  (32/0/12)

Engine version: 2019.2.2 tried optimising but actually made things slightly worse (1M plies/s)-------------------------------------------
(wins/draws/losses):     jp7                      jp6                      
jp7:                     0/0/0                    26/0/20                  (26/0/20)

Engine version: 2019.2.2 more optimization, ~1.6M plies/s-------------------------------------------------------------------------------------------------
(wins/draws/losses):     jp7                      jp6                      
jp7:                     0/0/0                    27/0/16                  (27/0/16)

Engine version: 2019.2.2 more optimization ~1.78M p/s-----------------------------------------------------------------------------------------------------
(wins/draws/losses):     jp7                      jp6                      
jp7:                     0/0/0                    36/0/25                  (36/0/25)

Engine version: 2019.2.2
(wins/draws/losses):     jp8                      jp7                      jp6                      
jp8:                     0/0/0                    7/1/15                   14/0/9                   (21/1/24)

Engine version: 2019.2.2
(wins/draws/losses):     jp8                      jp7                      jp6                      
jp8:                     0/0/0                    11/0/7                   9/0/9                    (20/0/16)
jp7:                     7/0/11                   0/0/0                    13/0/5                   (20/0/16)
jp6:                     9/0/9                    5/0/13                   0/0/0                    (14/0/22)

////////////////
